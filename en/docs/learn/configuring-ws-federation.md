# Configuring WS-Federation

WS-Federation (Web Services Federation) describes the management and
brokering of trust relationships and security token exchange across Web
services and organizational boundaries. WS-Federation is a part of the
larger WS-Security framework. For example, WS-Federation builds on the
Security Token Service (STS) by providing mechanisms that facilitate
interactions. In the WS-Federation Model, an Identity Provider is a
Security Token Service (STS). Service Providers depend on an Identity
Provider or Security Token Service to do the user authentication. OAuth
is an important protocol for IdP services as most major Web services are
also identity providers, mainly through the use of OAuth. These Web
services include Google, Facebook, Yahoo, AOL, Microsoft, PayPal,
MySpace, and Flickr among much more. Furthermore, all major email
providers offer OAuth IdP services.

In most instances it is necessary to secure the Security Token Service.
According to the Trust Brokering model defined in the WS-Trust
specification, the subject (user) should authenticate himself to the STS
before obtaining a token. STS may use this authentication information
when constructing the security token. For example, STS may populate the
required claims based on the user name provided by the subject.

To navigate to the federated authenticators configuration section, do
the following.

1.  Sign in. Enter your username and password to log on to the
    [Management
    Console](../../setup/getting-started-with-the-management-console).
    
2.  Navigate to the **Main** menu to access the **Identity** menu. Click
    **Add** under **Identity Providers**.  
    For more information, see [Adding and Configuring an Identity
    Provider](../../learn/adding-and-configuring-an-identity-provider).
    
3.  Fill in the details in the **Basic Information** section.

<!-- -->

1.  Expand the **WS-Federation(Passive) Configuration** form.  
    ![ws-federation-passive-configuration](../../assets/img/tutorials/ws-federation-passive-configuration.png)
    
2.  Fill in the following fields where relevant.

    <table>
    <colgroup>
    <col style="width: 33%" />
    <col style="width: 44%" />
    <col style="width: 22%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th>Field</th>
    <th>Description</th>
    <th>Sample value</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td>Enable Passive STS</td>
    <td>Selecting this option enables Passive STS to be used as an authenticator for users provisioned to the Identity Server.</td>
    <td>Selected</td>
    </tr>
    <tr class="even">
    <td>Default</td>
    <td>Selecting the <strong>Default</strong> checkbox signifies that Passive STS is the main/default form of authentication. This removes the selection made for any other <strong>Default</strong> checkboxes for other authenticators.</td>
    <td>Selected</td>
    </tr>
    <tr class="odd">
    <td>Passive STS Realm</td>
    <td>This is used as an identifier for the realm and can be any value.</td>
    <td>WSFederationHealthCare</td>
    </tr>
    <tr class="even">
    <td>Passive STS URL</td>
    <td><div class="content-wrapper">
    <p>When sending the authentication request, there is a request for a security token generated by WS-Trust.</p>
    <div class="admonition info">
	<p class="admonition-title">Note</p>    
	As long as the federated IdP is the WSO2 Identity Server, this URL must follow this format: <code>                                   https://(host-name):(port)/acs                                 </code></p>
    </div></div></td>
    <td><a href="https://localhost:9443/passivests/">https://localhost:9443/passivests/</a></td>
    </tr>
    <tr class="odd">
    <td>Passive STS User ID Location</td>
    <td>Select whether the User ID is found in 'Name Identifier' as part of the authentication request or if it is found among the claims. This specifies how the user is identified.</td>
    <td>User ID found in 'Name Identifier'</td>
    </tr>
    <tr class="even">
    <td>Additional Query Parameters</td>
    <td>This is necessary if you are connecting to another Identity Server or application. Sometimes extra parameters are required by this IS or application so these can be specified here.</td>
    <td>paramName1=value1</td>
    </tr>
    </tbody>
    </table>

!!! info "Configuring hostname verification"

	In previous releases, Passive STS Single-Logout (SLO) requests for
	service providers were initiated without hostname verification which can
	impose a security risk. From IS 5.2.0 release onwards, certificate
	validation has been enforced and hostname verification is enabled by
	default. If you want to disable the hostname verification, open the `	<IS_HOME>/repository/conf/deployment.toml	` file and add the following configuration.

	``` xml
	[saml.slo] 
	host_name_verification: false
	```

	!!! info
	
		- If the certificate is self-signed, import the service
		provider's public key to the IS client trust store to ensure that the
		SSL handshake in the SLO request is successful. For more information on
		how to do this, see [Managing Keystores with the UI]() in
		the WSO2 Product Administration Guide.
    
		- Identity Federation is part of the process of configuring an
		identity provider. For more information on how to configure an
		identity provider, see [Configuring an Identity
		Provider.](../../learn/adding-and-configuring-an-identity-provider)

